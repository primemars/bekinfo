baidu.more.ns("bk.editor");bk.editor.ani=function(B,_,A){if(B){this.time=B;}if(_){this.transform=_;}if(A){this.interval=A;}};bk.editor.ani.prototype={interval:40,transform:function(_){return 1-Math.pow(1-_,3);},time:2000,task:null,finishFunc:null,start:function(F,G){var E=this.interval,B=this.time,A=this.transform,H=A(1),D=0,_=this;this.finishFunc=G;function C(){D+=E;var C=D/B;if(C>=1){F(1);G&&G();clearInterval(_.task);}else{F(A(C)/H);}}this.task=setInterval(C,E);},stop:function(){if(this.task){clearInterval(this.task);}if(this.finishFunc){this.finishFunc();}}};baidu.more.ns("tools.image");tools.image.getImgSize=function(C,B){var _="BkImgGettingSize"+(new Date()).valueOf(),A=window[_]=document.createElement("IMG");A.onload=function(){var A=this;setTimeout(function(){B(A.width,A.height,window[_]);window[_]=null;},10);this.onload=null;};A.onerror=function(){B(0,0);window[_]=null;};A.src=C;};baidu.more.ns("bk");bk.albumInterim={addingImgIdx:0,addingCoverIdx:0,curImgIdx:0,curImgUrl:"",curImgWidth:0,curImgHeight:0,slidebarDragging:false,lastMousePosX:0,coverIdx:0,regionLeftCursor:'url("http://img.baidu.com/img/baike/editor/albumleftarrow.cur"),default',regionRightCursor:'url("http://img.baidu.com/img/baike/editor/albumrightarrow.cur"),default',regionCenterCursor:'url("http://img.baidu.com/img/baike/editor/zoomin.cur"),default',normalCursor:"default",ie7:baidu.ie==7,curAlbumData:null,viewUrl:"#",coverUrls:[],albumCount:0,curAlbumIdx:0,albumJumpFlag:"",albumDroplistIdx:0,toImg:"",toAlbum:"",bigShow:{},loadContent:{},jumpToAnotherAlbum:false,genCollectionList:function(){if(baidu.ie==6){document.execCommand("BackgroundImageCache",false,true);}this.loadContent={show:function(){baidu.show("content-loading");},go:function(_){baidu.setStyle("cl-bar","width",_*187+"px");},hide:function(){baidu.hide("content-loading");baidu.setStyle("cl-bar","width","0px");}};this.viewUrl="http://baike.baidu.com/view/"+g_albumData.lemmaId+".htm";baidu.g("nc-lemma-title").href=this.viewUrl;baidu.g("acs-lemma-link").href=this.viewUrl;baidu.g("nl-lemma-title").href=this.viewUrl;baidu.g("ns-lemma-title").href=this.viewUrl;baidu.g("as-own-lemma").href=this.viewUrl;baidu.g("nc-lemma-title").innerHTML=g_albumData.lemmaTitle;baidu.g("as-return2lemma").href=this.viewUrl;baidu.g("as-returnlemma").href=this.viewUrl;baidu.g("asso-bar").innerHTML=g_albumData.lemmaTitle+"\u8bcd\u6761\u56fe\u518c";this.bigShow=new bk.ShowPic();var D=baidu.string.getByteLength(g_albumData.lemmaTitle)*6+89;baidu.setStyle("ass-other-wrapper","width",D+"px");baidu.setStyle("asso-shadow","width",(D-21)+"px");var A=true;setTimeout(function(){baidu.on("acs-lemma-link","click",function(){nslog(window.location.href,"1246");});baidu.on("as-return2lemma","click",function(){nslog(window.location.href,"1257");});},10);if(g_summaryContent){baidu.show("ac-summary");baidu.g("ac-lemma-title").innerHTML=g_albumData.lemmaTitle;baidu.show("ac-lemma-title");var B=baidu.q("summary","ac-summary","p")[0];B.innerHTML=g_summaryContent+B.innerHTML;}baidu.g("aclt-lemma-title").innerHTML=g_albumData.lemmaTitle;this.albumCount=baidu.object.keys(g_albumData.albums).length;baidu.setStyle("assol-inner","width",89*this.albumCount+200+"px");if(this.albumCount>3){baidu.addClass("assol-rightbtn","slide-right-enable");}if(this.albumCount==0){baidu.show("acl-none");return;}else{if(this.albumCount==1){baidu.hide("ass-other-wrapper");}}baidu.g("aclt-album-count").innerHTML=this.albumCount;if(this.albumCount<5){baidu.addClass("als-up-btn","disable");baidu.addClass("als-down-btn","disable");}var _=this;for(var G in g_albumData.albums){var C=g_albumData.albums[G],F="http://imgsrc.baidu.com/baike/abpic/item/"+C.cover+".jpg";this.coverUrls.push([F,C.desc,C.pic.length,G,C.albumType]);}var E=window.location.hash.substr(1).split("$");if(E.length==2){baidu.hide("album-collection-outer");this.toAlbum=E[0]+" ";this.toImg=E[1];baidu.each(this.coverUrls,function(A,B){if(A[3]==_.toAlbum){_.curAlbumIdx=B;}});if(this.toImg){this.curAlbumData=g_albumData.albums[this.toAlbum];if(!this.curAlbumData){this.goToError();return;}this.curAlbumData.total=this.albumCount>1?this.curAlbumData.pic.length+1:this.curAlbumData.pic.length;var H=false;baidu.each(this.curAlbumData.pic,function(A,B){if(A.imgId==_.toImg){_.curImgIdx=B;H=true;}});if(!H){this.goToError();return;}this.goToShow(this.curImgIdx);A=false;}this.genAlbumList(this.toAlbum,false,A);A=false;}this.addNextCoverToList(A);},genAlbumList:function(B,C,A){baidu.hide("album-collection-outer");window.scrollTo(0,40);if(A){this.loadContent.show();}this.curAlbumData=g_albumData.albums[B];if(!this.curAlbumData){this.goToError();return;}this.curAlbumData.key=B;this.curAlbumData.total=this.albumCount>1?this.curAlbumData.pic.length+1:this.curAlbumData.pic.length;var _=this;this.coverIdx=baidu.array.indexOf(this.curAlbumData.pic,function(A,B){return A.imgId==_.curAlbumData.cover;});baidu.g("nl-lemma-title").innerHTML=g_albumData.lemmaTitle;baidu.g("ns-lemma-title").innerHTML=g_albumData.lemmaTitle;baidu.g("nl-album-desc").innerHTML=this.curAlbumData.desc;baidu.g("ns-album-desc").innerHTML=this.curAlbumData.desc;baidu.on("ns-album-desc","click",function(){_.goToList();});baidu.g("as-own-album").innerHTML=this.curAlbumData.desc;baidu.on("as-own-album","click",function(){_.goToList();});baidu.g("al-desc").innerHTML=this.curAlbumData.desc;baidu.g("al-count").innerHTML=this.curAlbumData.pic.length;baidu.g("as-own-lemma").innerHTML=g_albumData.lemmaTitle;baidu.g("as-more").href="http://image.baidu.com/i?ct=201326592&cl=2&lm=-1&tn=baiduimage&word="+baidu.url.escapeSymbol(g_albumData.lemmaTitle)+"&z=0&fr=bkimg";if(this.curAlbumData.total>=4){baidu.show("asss-bar");}else{baidu.hide("asss-bar");}baidu.setStyle("ass-window-inner","width",67*this.curAlbumData.total+100+"px");baidu.setStyle("ass-window-inner","left","0");if(this.curAlbumData.pic.length==1){baidu.addClass("as-next","disable");baidu.addClass("as-prev","disable");}else{baidu.removeClass("as-next","disable");baidu.removeClass("as-prev","disable");}_=this;baidu.each(baidu.q("als-item","als-window-inner","div"),function(A,C){if(A.getAttribute("idx")==B){_.curAlbumIdx=C;baidu.addClass(A,"selected");}else{baidu.removeClass(A,"selected");}});baidu.g("al-container").innerHTML="";baidu.g("ass-window-inner").innerHTML="";if(!this.toImg){window.location.hash="#"+parseInt(B)+"$";}this.addingImgIdx=0;this.addNextImgToList(C,A);},getRegion:function(E,B){var D=baidu.dom.getPosition("as-left-region"),_=D.left,C=D.top,A=E-_;if(0<B-C<526&&0<A<690){if(A<281){return"as-left-region";}else{if(A<421){return"as-center-region";}else{return"as-right-region";}}}else{return"";}},addingImg:false,addNextImgToList:function(D,B){this.addingImg=true;var A=this;if(this.addingImgIdx==this.curAlbumData.pic.length){if(this.albumCount>1){baidu.g("ass-window-inner").innerHTML+='<a class="next" href="javascript:void(0);" onclick="return false;" data-idx="next"></a>';}if(this.albumJumpFlag){if(this.albumJumpFlag=="next"){this.gotoImg(0);}else{this.gotoImg(this.curAlbumData.pic.length-1);}baidu.g("alt-content").innerHTML="\u60a8\u6b63\u5728\u6d4f\u89c8\u201c"+this.coverUrls[this.curAlbumIdx][1]+"\u201d\u56fe\u518c";setTimeout(function(){baidu.hide("alt-btn");},10);baidu.show("as-last-tip");}else{if(this.toImg){baidu.each(baidu.g("ass-window-inner").getElementsByTagName("A"),function(B,_){if(B.getAttribute("data-idx")==A.curImgIdx){baidu.addClass(B,"selected");}else{baidu.removeClass(B,"selected");}});}else{if(B){this.loadContent.hide();}this.goToList();}}this.updateAlbumInnerWindow(true,!D);this.albumJumpFlag="";this.toImg="";this.addingImg=false;this.updateCurrentAlbum();return;}if(this.coverUrls[this.curAlbumIdx][3]!=this.curAlbumData.key){return;}var C={imgId:this.curAlbumData.pic[this.addingImgIdx].imgId,imgDesc:this.curAlbumData.pic[this.addingImgIdx].imgDesc,cover:this.curAlbumData.cover},_="http://imgsrc.baidu.com/baike/abpic/item/"+C.imgId+".jpg";tools.image.getImgSize(_,function(I,H,J){var F=document.createElement("DIV");F.className="al-wrapper";var E,K;if(I*110>H*149){K=parseInt(149*H/I);E=149;}else{E=parseInt(110*I/H);K=110;}F.innerHTML='<a href="javascript:void(0);" onclick="return false;" class="al-foto-wrapper"><img src="'+_+'" width="'+E+'" height="'+K+'" data-idx="'+A.addingImgIdx+'" style="top:'+Math.floor(55-K/2)+"px;left:"+Math.floor(75-E/2)+'px;"/></a><p class="desc">'+C.imgDesc+"</p>";if(C.imgId==C.cover){F.innerHTML+='<div class="logo"></div>';}baidu.g("al-container").appendChild(F);var G=document.createElement("A");G.href="javascript:void(0);";G.onclick=function(){return false;};G.setAttribute("data-idx",A.addingImgIdx);if(I>H){G.innerHTML='<img width="58" style="top:'+Math.ceil(29-29*H/I)+'px;" src="'+_+'">';}else{G.innerHTML='<img height="58" style="left:'+Math.ceil(29-29*I/H)+'px;" src="'+_+'">';}baidu.g("ass-window-inner").appendChild(G);A.addingImgIdx++;if(B){A.loadContent.go(A.addingImgIdx/A.curAlbumData.pic.length);}A.addNextImgToList(D,B);});},addNextCoverToList:function(C){var B=this;if(this.addingCoverIdx==this.coverUrls.length){var A=document.createElement("DIV");A.className="clear";var D=A.cloneNode(true);if(baidu.g("acl-zw").show){baidu.g("acl-zw").appendChild(D);}else{baidu.hide("acl-zw");}if(baidu.g("acl-kz").show){baidu.g("acl-kz").appendChild(A);}else{baidu.hide("acl-kz");}this.registEvent();if(this.toAlbum){baidu.each(baidu.q("als-item","als-window-inner","div"),function(_,A){if(A==B.curAlbumIdx){baidu.addClass(_,"selected");}else{baidu.removeClass(_,"selected");}});}else{if(C){this.loadContent.hide();}this.goToCollection();}this.toAlbum="";this.updateCurrentAlbum();return;}var _=this.coverUrls[this.addingCoverIdx][0];tools.image.getImgSize(_,function(H,G){var D=document.createElement("DIV");D.className="acl-item";var A=0,L=0;if(H>G){L=parseInt(133*G/H);A=133;}else{A=parseInt(133*H/G);L=133;}var I=A+4,K=L+4;D.innerHTML='<div class="acli-img" style="width:'+(I+8)+"px; left:"+Math.floor((137-I)/2)+'px;"><div class="b1" style="width:'+I+"px;height:"+K+'px;"></div><div class="b2" style="width:'+I+"px;height:"+K+'px;"></div><div class="b3" style="width:'+I+"px; height:"+K+'px;"></div><img src="'+_+'" width="'+A+'" height="'+L+'" onclick="bk.albumInterim.genAlbumList(\''+B.coverUrls[B.addingCoverIdx][3]+'\', false, true);nslog(window.location.href,\'1245\');" ondragstart="return false;"/></div><p class="desc">'+B.coverUrls[B.addingCoverIdx][1]+'<span class="count">('+B.coverUrls[B.addingCoverIdx][2]+"\u5f20)</span></p>";if(B.coverUrls[B.addingCoverIdx][4]=="albums"){baidu.g("acl-zw").appendChild(D);baidu.g("acl-zw").show=true;}else{baidu.g("acl-kz").appendChild(D);baidu.g("acl-kz").show=true;}var E=document.createElement("DIV");E.className="als-item";E.setAttribute("idx",B.coverUrls[B.addingCoverIdx][3]);var F=9,J=15;if(H*78>G*108){L=parseInt(108*G/H);A=108;F+=Math.floor((78-L)/2);}else{A=parseInt(78*H/G);L=78;J+=Math.floor((108-A)/2);}E.innerHTML='<div class="arrow"></div><div class="b1"></div><div class="b2"></div><div class="b3"></div><img src="'+_+'" width="'+A+'" height="'+L+'" style="top:'+F+"px;left:"+J+'px;"/><div class="desc" title="'+B.coverUrls[B.addingCoverIdx][1]+'">'+B.strLimit(B.coverUrls[B.addingCoverIdx][1],14)+'<span class="count">('+B.coverUrls[B.addingCoverIdx][2]+"\u5f20)</span></div>";baidu.g("als-window-inner").appendChild(E);E=document.createElement("DIV");E.className="assol-item";E.setAttribute("idx",B.coverUrls[B.addingCoverIdx][3]);F=0,J=0;if(H>G){L=parseInt(85*G/H);A=85;F=85-L;}else{A=parseInt(85*H/G);L=85;J=(93-A)/2;}I=A+2,K=L+2;E.innerHTML='<div class="b1" style="top:'+(F+4)+"px; left:"+J+"px; width:"+I+"px; height:"+K+'px;"></div><div class="b1" style="top:'+(F+2)+"px; left:"+(J+2)+"px; width:"+I+"px; height:"+K+'px;"></div><div class="b2" style="top:'+F+"px; left:"+(J+4)+"px; width:"+I+"px; height:"+K+'px;"></div><img onselectstart="return false;" unselectable="on" src="'+_+'" width="'+A+'" height="'+L+'" style="top:'+(F+2)+"px;left:"+(J+6)+'px;"/><div class="placeholder"></div><div class="desc" title="'+B.coverUrls[B.addingCoverIdx][1]+'">'+B.strLimit(B.coverUrls[B.addingCoverIdx][1],14)+'<span class="count">('+B.coverUrls[B.addingCoverIdx][2]+"\u5f20)</span></div>";baidu.g("assol-inner").appendChild(E);B.addingCoverIdx++;if(C){B.loadContent.go(B.addingCoverIdx/B.coverUrls.length);}B.addNextCoverToList(C);});},mouseoverHandler:function(_){if(!this.curAlbumData||this.curAlbumData.pic.length==1){return;}if(_.id=="as-last-tip"||baidu.dom.contains("as-last-tip",_)){return;}if(baidu.dom.hasClass(document.body,"dragging")){return;}if(baidu.getStyle("album-show","display")=="none"){return;}},registEvent:function(){var _=this;baidu.on("album-list-outer","click",function(B){if(_.toggleAni){return;}var C=baidu.event.getTarget(B),A=-1;if(C.nodeName=="A"&&C.className=="al-foto-wrapper"){C=C.getElementsByTagName("IMG")[0];}if(C.nodeName=="IMG"){A=C.getAttribute("data-idx");}if(A&&A!=-1){nslog(window.location.href,"1214");_.goToShow(A);}});baidu.on("als-window-inner","click",function(B){if(_.addingImg){return;}if(_.toggleAni){return;}var C=baidu.event.getTarget(B),A=-1;if(C.nodeName=="DIV"&&baidu.dom.hasClass(C,"als-item")){A=C.getAttribute("idx");}else{if(C.parentNode.nodeName=="DIV"&&baidu.dom.hasClass(C.parentNode,"als-item")){A=C.parentNode.getAttribute("idx");}}if(A&&A!=-1){_.genAlbumList(A,true,false);nslog(window.location.href,"1248");}});baidu.on("as-return2list","click",function(){if(_.toggleAni){return;}_.goToList();window.location.hash=window.location.hash.replace(/\$.*$/,"$");nslog(window.location.href,"1225");});baidu.on("ass-window-inner","click",function(B){if(_.toggleAni){return;}var C=baidu.event.getTarget(B);if(C.nodeName=="A"||(C.nodeName=="IMG"&&(C=C.parentNode))){var A=C.getAttribute("data-idx");nslog(window.location.href,"1218");var D=false;if(A=="prev"||A=="next"){D=true;}_.gotoImg(A,D);}});baidu.on("alt-btn","click",function(){if(baidu.g("alt-btn").innerHTML=="\u6d4f\u89c8\u4e0b\u4e00\u56fe\u518c"){nslog(window.location.href,"1208");_.gotoImg("next");}else{nslog(window.location.href,"1210");_.gotoImg("prev");}});baidu.on("as-last-tip-close","click",function(){if(_.toggleAni){return;}baidu.hide("as-last-tip");nslog(window.location.href,"1223");});baidu.on("ass-left-btn","click",function(){if(_.toggleAni){return;}_.goLeft();});baidu.on("ass-right-btn","click",function(){if(_.toggleAni){return;}_.goRight();});baidu.on(window.document.body,"click",function(B){if(_.toggleAni){return;}var C=baidu.event.getTarget(B);if(C.id=="as-last-tip"||baidu.dom.contains("as-last-tip",C)){return;}var A=C.id||"";if(A=="as-left-region"){_.goPrev();}else{if(A=="as-right-region"){_.goForward();}else{if(A=="as-center-region"){_.goBigpic();}}}});baidu.on(document,"keyup",function(A){if(_.toggleAni){return;}if(baidu.getStyle("album-show","display")=="block"){var B=baidu.event.getKeyCode(A);if(B==37){_.goPrev();}else{if(B==39){_.goForward();}}}});baidu.on("as-prev","click",function(){if(_.toggleAni){return;}_.goPrev();});baidu.on("as-next","click",function(){if(_.toggleAni){return;}_.goForward();});baidu.on(document.body,"mouseover",function(A){if(_.toggleAni){return;}var B=baidu.event.getTarget(A);_.mouseoverHandler(B);});baidu.on(document.body,"mouseup",function(){if(_.toggleAni){return;}if(_.slidebarDragging){_.slidebarDragging=false;baidu.removeClass(document.body,"dragging");nslog(window.location.href,"1220");}});baidu.on(document.body,"mousemove",function(A){if(_.toggleAni){return;}var D=baidu.event.getPageX(A),B=baidu.event.getPageY(A);if(D<20||D>baidu.page.getWidth()-20||B<20||B>baidu.page.getHeight()-20){_.slidebarDragging=false;baidu.removeClass(document.body,"dragging");}else{if(_.slidebarDragging){var C=baidu.dom.getPosition("ass-slider-bar");if(D>C.left&&D<C.left+262){_.slidebarDragHandler(D,B);}}}});baidu.on("asss-bar","mousedown",function(A){if(_.toggleAni){return;}_.slidebarDragging=true;baidu.addClass(document.body,"dragging");document.title+="mousedowen"+_.lastMousePosX;_.lastMousePosX=baidu.event.getPageX(A);window.getSelection&&window.getSelection().removeAllRanges();document.selection&&document.selection.empty();});baidu.on("as-bigpic","click",function(){_.goBigpic();nslog(window.location.href,"1203");nslog(window.location.href,"1227");return false;});baidu.on("as-contributer","click",function(){nslog(window.location.href,"1241");});baidu.on("as-own-lemma","click",function(){nslog(window.location.href,"1242");});baidu.on("as-own-album","click",function(){nslog(window.location.href,"1243");});baidu.on("as-more","click",function(){nslog(window.location.href,"1244");});baidu.on("als-up-btn","click",function(){if(_.albumCount<5){return;}nslog(window.location.href,"1247");if(_.firstAlbumIdx>0){_.firstAlbumIdx--;}_.updateAlbumInnerWindow(false,false);});baidu.on("als-down-btn","click",function(){if(_.albumCount<5){return;}nslog(window.location.href,"1247");if(_.firstAlbumIdx<_.albumCount-4){_.firstAlbumIdx++;}_.updateAlbumInnerWindow(false,false);});baidu.on("assol-leftbtn","click",function(){if(_.albumCount<3){return;}if(_.albumDroplistIdx>0){_.albumDroplistIdx--;}_.updateDroplistInnerWindow();});baidu.on("assol-rightbtn","click",function(){if(_.albumCount<3){return;}if(_.albumDroplistIdx<_.albumCount-2){_.albumDroplistIdx++;}_.updateDroplistInnerWindow();});var B=null;baidu.on("ass-other-wrapper","click",function(_){nslog(window.location.href,"1255");if(baidu.getStyle("asso-list","display")=="none"){baidu.show("asso-shadow");baidu.show("asso-list");baidu.g("asso-arrow").className="asso-arrow-up";if(B){B.stop();}baidu.setStyle("asso-list","height","1px");var C=1,A=146;this.showAni=new bk.editor.ani(130,function(_){return _;},17);this.showAni.start(function(_){baidu.setStyle("asso-list","height",C+(A-C)*_+"px");},function(){baidu.setStyle("asso-list","height",A+"px");B=null;});}else{baidu.hide("asso-list");baidu.g("asso-arrow").className="asso-arrow";baidu.hide("asso-shadow");baidu.setStyle("as-more","margin-top","20px");}});baidu.on("nl-collection","click",function(){_.goToCollection();});baidu.on("ns-collection","click",function(){_.goToCollection();});baidu.on("als-return","click",function(){_.goToCollection();nslog(window.location.href,"1249");});baidu.on("as-returnlemma","click",function(){nslog(window.location.href,"3604");});var A=function(A){if(_.albumCount<5){return;}A=A||window.event;var B=A.wheelDelta?(A.wheelDelta/120):(-A.detail/3);_.firstAlbumIdx-=B;if(_.firstAlbumIdx<0){_.firstAlbumIdx=0;}else{if(_.firstAlbumIdx>=_.albumCount-4){_.firstAlbumIdx=_.albumCount-4;}}_.updateAlbumInnerWindow(false,false);baidu.event.preventDefault(A);};if(document.addEventListener){baidu.g("als-window-inner").addEventListener("DOMMouseScroll",A,false);}baidu.g("als-window-inner").onmousewheel=A;baidu.each(baidu.q("assol-item","assol-inner","div"),function(A,B){(function(B){baidu.on(A,"click",function(){if(_.addingImg){return;}nslog(window.location.href,"1256");_.curAlbumData=g_albumData.albums[_.coverUrls[B][3]];_.curAlbumData.total=_.albumCount>1?_.curAlbumData.pic.length+1:_.curAlbumData.pic.length;_.curAlbumIdx=B;_.toImg=_.curAlbumData.pic[0].imgId;_.curImgIdx=0;_.jumpToAnotherAlbum=true;_.goToShow(_.curImgIdx);_.genAlbumList(_.coverUrls[B][3],false,false);});}(B));});},updateCurrentAlbum:function(){var _=this;baidu.each(baidu.q("assol-item","assol-inner","div"),function(A){if(A.getAttribute("idx")==_.coverUrls[_.curAlbumIdx][3]){baidu.addClass(A,"current");}else{baidu.removeClass(A,"current");}});if(_.albumCount>2){if(_.curAlbumIdx==0){_.albumDroplistIdx=0;}else{if(_.curAlbumIdx==_.albumCount-1){_.albumDroplistIdx=_.curAlbumIdx-1;}else{_.albumDroplistIdx=_.curAlbumIdx;}}_.updateDroplistInnerWindow();}},gotoPrevAlbum:function(){this.albumJumpFlag="prev";this.curAlbumIdx--;if(this.curAlbumIdx<0){this.curAlbumIdx=this.coverUrls.length-1;}this.curAlbumData=g_albumData.albums[this.coverUrls[this.curAlbumIdx][3]];this.genAlbumList(this.coverUrls[this.curAlbumIdx][3],false,false);},gotoNextAlbum:function(){this.albumJumpFlag="next";this.curAlbumIdx++;if(this.curAlbumIdx==this.coverUrls.length){this.curAlbumIdx=0;}this.curAlbumData=g_albumData.albums[this.coverUrls[this.curAlbumIdx][3]];this.genAlbumList(this.coverUrls[this.curAlbumIdx][3],false,false);},gotoImg:function(B,E){if(g_albumtype){nslog(window.location.href,g_albumtype);}nslog(window.location.href,"1230");if(bk.albumInterim.relateFlag){nslog(window.location.href,"3625");}if(B=="prev"){baidu.hide("as-last-tip");this.gotoPrevAlbum();return;}else{if(B=="next"){baidu.hide("as-last-tip");this.gotoNextAlbum();return;}}B=B*1;if((B!==0&&!B)||B<0||B>=this.curAlbumData.total){return;}if(baidu.getStyle("as-last-tip","display")!="none"){baidu.hide("as-last-tip");setTimeout(function(){baidu.hide("alt-btn");},10);nslog(window.location.href,"1224");}if(this.jumpToAnotherAlbum){baidu.g("alt-content").innerHTML="\u60a8\u6b63\u5728\u6d4f\u89c8\u201c"+this.coverUrls[this.curAlbumIdx][1]+"\u201d\u56fe\u518c";this.jumpToAnotherAlbum=false;baidu.show("as-last-tip");setTimeout(function(){baidu.hide("alt-btn");},10);}this.curImgIdx=B;baidu.g("as-pager").innerHTML=(B+1)+"&nbsp;/&nbsp;"+this.curAlbumData.pic.length;baidu.each(baidu.g("ass-window-inner").getElementsByTagName("A"),function(A,_){if(A.getAttribute("data-idx")==B){baidu.addClass(A,"selected");}else{baidu.removeClass(A,"selected");}});var A=this;baidu.hide("as-right-part");var C=this.curAlbumData.pic[B];baidu.g("as-contributer").innerHTML=C.owner;baidu.g("as-contributer").href="http://passport.baidu.com/?business&aid=7&default_tab=2&un="+C.owner+"#3";baidu.g("as-desc").innerHTML=C.imgDesc;baidu.g("as-desc").innerHTML=C.imgDesc;if(!C.dictTip&&!C.dict){baidu.hide("ref");baidu.hide("ref-link");baidu.hide("ref-title");}else{baidu.show("ref");if(C.dictTip){baidu.g("ref-title").innerHTML=C.dictTip;baidu.show("ref-title");}else{baidu.hide("ref-title");}if(C.dict){baidu.show("ref-link");baidu.g("rl").href=C.dict;baidu.g("rl").innerHTML=A.strLimit(C.dict,40);}else{baidu.hide("ref-link");}}baidu.show("as-right-part");if(this.curAlbumData.total>3){this.firstImgIdx=(this.curImgIdx>=this.curAlbumData.total-2)?(this.curAlbumData.total-3):(this.curImgIdx<=1?0:(this.curImgIdx-1));}this.updateImgSlideBar();this.updateImgInnerWindow();var A=this,_="http://imgsrc.baidu.com/baike/pic/item/"+this.curAlbumData.pic[B].imgId+".jpg",D=baidu.g("as-img");D.src="http://img.baidu.com/img/baike/editor/imgloading.gif";D.width=37;D.height=37;baidu.setStyles(D,{top:"222px",left:"302px"});A.curImgUrl=_;tools.image.getImgSize(_,function(D,C){var B=D,F=C;if(B>688||F>516){if(B*516>F*688){F=688*F/B;B=688;}else{B=516*B/F;F=516;}}var E=baidu.g("as-img");baidu.setStyles(E,{top:Math.ceil(258-F/2)+4+"px",left:Math.ceil(344-B/2)+4+"px"});E.width=B;E.height=F;A.updateImgShow(E,_);A.curImgWidth=D;baidu.g("as-size").innerHTML=D+"\xd7"+C+(baidu.ie?("&nbsp;-&nbsp;"+Math.ceil(E.fileSize/1024)+"K"):"");});window.location.hash="#"+parseInt(this.coverUrls[this.curAlbumIdx][3])+"$"+this.curAlbumData.pic[B].imgId;},updateAssBtn:function(){if(this.curAlbumData.total<=3){baidu.addClass("ass-right-btn","disable");baidu.addClass("ass-left-btn","disable");return;}if(this.firstImgIdx==0){baidu.addClass("ass-left-btn","disable");}else{baidu.removeClass("ass-left-btn","disable");}if(this.firstImgIdx==this.curAlbumData.total-3){baidu.addClass("ass-right-btn","disable");}else{baidu.removeClass("ass-right-btn","disable");}},updateAlsBtn:function(){if(this.albumCount<=4){return;}if(this.firstAlbumIdx==0){baidu.addClass("als-up-btn","disable");}else{baidu.removeClass("als-up-btn","disable");}if(this.firstAlbumIdx==this.albumCount-4){baidu.addClass("als-down-btn","disable");}else{baidu.removeClass("als-down-btn","disable");}},updateDroplistBtn:function(){if(this.albumCount<3){return;}if(this.albumDroplistIdx==0){baidu.removeClass("assol-leftbtn","slide-left-enable");}else{baidu.addClass("assol-leftbtn","slide-left-enable");}if(this.albumDroplistIdx==this.albumCount-2){baidu.removeClass("assol-rightbtn","slide-right-enable");}else{baidu.addClass("assol-rightbtn","slide-right-enable");}},goBigpic:function(){this.bigShow.show(this.curImgUrl);nslog(window.location.href,"1226");},goForward:function(){if(this.curAlbumData.total==1){return;}nslog(window.location.href,"1217");this.curImgIdx++;if(this.curImgIdx==this.curAlbumData.pic.length){this.curImgIdx="next";}this.gotoImg(this.curImgIdx);},goPrev:function(){if(this.curAlbumData.total==1){return;}nslog(window.location.href,"1216");this.curImgIdx--;if(this.curImgIdx==-1){this.curImgIdx="prev";}this.gotoImg(this.curImgIdx);},goRight:function(){if(this.firstImgIdx==this.curAlbumData.total-3){return;}nslog(window.location.href,"1219");this.firstImgIdx++;this.updateInnerWindowNoMove();},goLeft:function(){if(this.firstImgIdx==0){return;}nslog(window.location.href,"1219");this.firstImgIdx--;this.updateInnerWindowNoMove();},imgSlideBarAni:null,albumInnerWindowAni:null,innerWindowAni:null,droplistWindowAni:null,imgShowAni:null,toggleAni:null,firstImgIdx:0,firstAlbumIdx:0,updateImgShow:function(B,_){if(this.imgShowAni){this.imgShowAni.stop();}baidu.setStyle(B,"opacity",0);B.src=_;var A=this;this.imgShowAni=new bk.editor.ani(this.ie7?1:180,null,37);this.imgShowAni.start(function(_){baidu.setStyle(B,"opacity",_);},function(){baidu.setStyle(B,"opacity",1);var C=baidu.page.getMousePosition(),_=A.getRegion(C.x,C.y);if(_){A.mouseoverHandler(baidu.g(_));}});},updateImgSlideBar:function(){this.updateAssBtn();if(this.curAlbumData.total<=3){return;}if(this.imgSlideBarAni){this.imgSlideBarAni.stop();this.imgSlideBarAni=null;}var B=parseInt(baidu.getStyle("asss-bar","left")),A=Math.floor(155*this.firstImgIdx/(this.curAlbumData.total-3));if(B==A){return;}var _=this;this.imgSlideBarAni=new bk.editor.ani(180,function(_){return _;},19);this.imgSlideBarAni.start(function(_){baidu.setStyle("asss-bar","left",B+(A-B)*_+"px");},function(){baidu.setStyle("asss-bar","left",A+"px");_.imgSlideBarAni=null;});},updateAlbumInnerWindow:function(A,D){if(this.albumCount<=4){return;}if(this.albumInnerWindowAni){this.albumInnerWindowAni.stop();this.albumInnerWindowAni=null;}var C=parseInt(baidu.getStyle("als-window-inner","top")),B=C,_=this;if(A){if(this.curAlbumIdx<2){this.firstAlbumIdx=0;}else{if(this.curAlbumIdx>=this.albumCount-3){this.firstAlbumIdx=this.albumCount-4;}else{this.firstAlbumIdx=this.curAlbumIdx-1;}}}B=-122*this.firstAlbumIdx;this.updateAlsBtn();if(C==B){return;}this.albumInnerWindowAni=new bk.editor.ani(D?1:130,function(_){return _;},17);this.albumInnerWindowAni.start(function(_){baidu.setStyle("als-window-inner","top",C+(B-C)*_+"px");},function(){baidu.setStyle("als-window-inner","top",B+"px");_.albumInnerWindowAni=null;});},updateImgInnerWindow:function(){if(this.curAlbumData.total<=3){return;}if(this.innerWindowAni){this.innerWindowAni.stop();}var _=this,B=parseInt(baidu.getStyle("ass-window-inner","left")),A=-this.firstImgIdx*67;if(B==A){return;}this.innerWindowAni=new bk.editor.ani(130,function(_){return _;},17);this.innerWindowAni.start(function(_){baidu.setStyle("ass-window-inner","left",B+(A-B)*_+"px");},function(){baidu.setStyle("ass-window-inner","left",A+"px");_.innerWindowAni=null;});},updateDroplistInnerWindow:function(){if(!this.curAlbumData){return;}if(this.albumCount<=2){return;}if(this.droplistWindowAni){this.droplistWindowAni.stop();}var _=this,B=parseInt(baidu.getStyle("assol-inner","left")),A=-this.albumDroplistIdx*99;if(B==A){return;}this.droplistWindowAni=new bk.editor.ani(130,function(_){return _;},17);this.droplistWindowAni.start(function(_){baidu.setStyle("assol-inner","left",B+(A-B)*_+"px");},function(){baidu.setStyle("assol-inner","left",A+"px");_.droplistWindowAni=null;});this.updateDroplistBtn();},updateInnerWindowNoMove:function(){if(this.curAlbumData.total<=3){return;}if(this.innerWindowAni){this.innerWindowAni.stop();}var B=parseInt(baidu.getStyle("ass-window-inner","left")),A=-this.firstImgIdx*67,_=this;if(B==A){return;}this.innerWindowAni=new bk.editor.ani(130,function(_){return _;},17);this.innerWindowAni.start(function(_){baidu.setStyle("ass-window-inner","left",B+(A-B)*_+"px");},function(){baidu.setStyle("ass-window-inner","left",A+"px");_.innerWindowAni=null;});this.updateImgSlideBar();},slidebarDragHandler:function(C,B){if(!this.lastMousePosX){this.lastMousePosX=C;}var A=parseInt(baidu.getStyle("asss-bar","left"));A+=C-this.lastMousePosX;this.lastMousePosX=C;window.getSelection&&window.getSelection().removeAllRanges();document.selection&&document.selection.empty();if(A<0||A>155){return;}baidu.setStyle("asss-bar","left",A+"px");var _=Math.floor(67*(3-this.curAlbumData.total)*A/155);baidu.setStyle("ass-window-inner","left",_+"px");this.firstImgIdx=Math.floor(-_/67);this.updateAssBtn();},goToList:function(){baidu.hide("asso-list");baidu.g("asso-arrow").className="asso-arrow";baidu.hide("asso-shadow");baidu.setStyle("as-more","margin-top","20px");if(g_albumtype){nslog(window.location.href,g_albumtype);}nslog(window.location.href,"1213");baidu.hide("navbar-collection");baidu.hide("album-collection-outer");baidu.hide("album-show");baidu.hide("navbar-show");var _=Math.ceil(this.curAlbumData.pic.length/4)*190;if(_<590){_=590;}baidu.setStyle("al-container","height",_+"px");baidu.show("navbar-list");baidu.show("album-list-outer");this.updateCurrentAlbum();document.title=this.coverUrls[this.curAlbumIdx][1]+"_\u767e\u5ea6\u767e\u79d1";window.location.hash=window.location.hash.replace(/\$.*$/,"$");window.scrollTo(0,40);},goToShow:function(A){this.loadContent.hide();baidu.hide("album-list-outer");baidu.hide("navbar-list");baidu.hide("navbar-collection");baidu.hide("album-collection-outer");window.scrollTo(0,40);baidu.show("navbar-show");baidu.show("album-show");var _=this;this.updateCurrentAlbum();this.gotoImg(A);document.title=this.coverUrls[this.curAlbumIdx][1]+"_\u767e\u5ea6\u767e\u79d1";},goToCollection:function(){baidu.hide("asso-list");baidu.g("asso-arrow").className="asso-arrow";baidu.hide("asso-shadow");baidu.setStyle("as-more","margin-top","20px");baidu.hide("album-show");baidu.hide("navbar-show");baidu.hide("navbar-list");baidu.hide("album-list-outer");baidu.show("navbar-collection");baidu.show("album-collection-outer");document.title=g_albumData.lemmaTitle+"\u56fe\u518c_\u767e\u5ea6\u767e\u79d1";window.location.hash=".";window.scrollTo(0,40);if(g_albumtype){nslog(window.location.href,g_albumtype);}nslog(window.location.href,"1229");},strLimit:function(A,_){var B=baidu.string.getByteLength(A);if(B>_){return baidu.string.subByte(A,_-4)+"...";}else{return A;}},goToError:function(){nslog(window.location.href,"1259");baidu.hide("navbar-collection");this.loadContent.hide();baidu.show("navbar-error");baidu.show("error-page");baidu.each(baidu.g("error-page").getElementsByTagName("A"),function(_,A){_.href=window.location.href.replace(/#.*$/,"");});baidu.g("epc-lemma").innerHTML=g_albumData.lemmaTitle;setTimeout(function(){window.location.href=window.location.href.replace(/#.*$/,"");},5000);},showRelate:function(){baidu.ajax.get("/api/relatedalbum?lemmaId="+g_albumData.lemmaId+"&t="+Math.random(),function(_,A){if(A.length){bk.albumInterim.relate(baidu.json.parse(A));bk.albumInterim.relateFlag=true;}});},relate:function(B){var _=this;if(B.length){nslog(window.location.href,3625);baidu.g("relate-inner").style.width=B.length*103*2+200+"px";var A=[];baidu.each(B,function(E){var D="/albums/"+E.lemmaId+"/"+E.subLemmaId+".html#"+E.albumId+"$"+E.cover,B="http://imgsrc.baidu.com/baike/abpic/item/"+E.cover+".jpg",C='<li class="relate-li" style="visibility:hidden;"><div class="b1"><a class="img-wrapper" target="_blank" href="'+D+'"><img src="'+B+"\" onload=\"tools.image.sizelimit(this, 85, 85);var ptNode=baidu.dom.getAncestorByClass(this, 'b1');"+"baidu.dom.setAttrs(ptNode, {style:'margin-top:'+(85-this.height)+'px;margin-left:' + (85-this.width)/2 +'px;'});"+'ptNode.parentNode.style.visibility=\'visible\';" /></a><div class="b2"><div class="b3"></div></div></div><div title="'+E.desc+'" class="desc">'+_.strLimit(E.desc,14)+"</div></li>";A.push(C);});baidu.g("holder1").innerHTML=A.join("");baidu.show("album-relate");if(B.length>2){SlideEffect.play("relate-outer","holder1","holder2","relate-left","relate-right",{width:103,speed:10,auto:false});}else{baidu.removeClass("relate-right","slide-right-enable");baidu.removeClass("relate-left","slide-left-enable");}}}};baidu.dom.ready(function(){bk.albumInterim.genCollectionList();nslog(window.location.href,"1623");});var bk=bk||{};bk.ShowPic=function(A){A=baidu.object.extend({src:"",overlayBgColor:"#000",overlayOpacity:0.8,imageLoading:"http://img.baidu.com/img/baike/relation/jquery/lightbox-ico-loading.gif",imageBlank:"http://img.baidu.com/img/baike/relation/jquery/lightbox-blank.gif",containerBorderSize:10,containerResizeSpeed:400},A);this.show=function(_){A.src=_;D();F();};var B;function D(){var C=baidu.dom.create("div",{id:"bk-sp"});C.innerHTML='<div id="sp-container-image-box"><div id="sp-container-image"><img id="sp-image"><div id="sp-loading">'+'<a href="#" id="sp-loading-link"><img src="'+A.imageLoading+'"></a></div></div></div>';document.body.appendChild(baidu.dom.create("div",{id:"bk-sp-overlay"}));document.body.appendChild(C);B=[baidu.page.getWidth(),baidu.page.getHeight(),baidu.page.getViewWidth(),baidu.page.getViewHeight()];baidu.setStyles("bk-sp-overlay",{backgroundColor:"#000",opacity:A.overlayOpacity,width:B[0],height:B[1]});var _=[baidu.page.getScrollLeft(),baidu.page.getScrollTop()];baidu.setStyles("bk-sp",{top:_[1]+(B[3]/20),left:_[0]});baidu.on("bk-sp-overlay","click",G);baidu.on("bk-sp","click",G);baidu.on("sp-loading-link","click",function(){G();return false;});baidu.on(window,"resize",function(){var A=[baidu.page.getWidth,baidu.page.getHeight,baidu.page.getViewWidth,baidu.page.getViewHeight];baidu.setStyles("bk-sp-overlay",{backgroundColor:"#000",opacity:0.8,width:A[0],height:A[1]});var _=[baidu.page.getScrollLeft,baidu.page.getScrollTop];baidu.setStyles("bk-sp",{top:_[1]+(A[3]/20),left:_[0]});});}function F(){baidu.show("sp-loading");baidu.hide("sp-image");var _=A.src,B=new Image();B.onload=function(){baidu.dom.setAttr("sp-image","src",_);E(B.width,B.height);B.onload=function(){};};B.src=_;}function E(L,N){var F=this,D=baidu.dom.getComputedStyle("sp-container-image-box","width"),K=baidu.dom.getComputedStyle("sp-container-image-box","height"),I=(L+(A.containerBorderSize*2)),E=(N+(A.containerBorderSize*2)),H=D-I,G=K-E,J=new bk.editor.ani(1000),M=E+parseInt(baidu.g("bk-sp").style.top);if(M>B[1]){baidu.setStyle("bk-sp-overlay","height",M+20);}J.start(function(_){baidu.setStyle("sp-container-image-box","width",_*I);baidu.setStyle("sp-container-image-box","height",_*E);},function(){C();});if((H==0)&&(G==0)){if($.browser.msie){_(250);}else{_(100);}}}function C(){baidu.hide("sp-loading");baidu.fx.fadeIn("sp-image");}function _(A){var B=new Date();_=null;do{var _=new Date();}while(_-B<A);}function G(){baidu.fx.remove("bk-sp",{});baidu.fx.remove("bk-sp-overlay",{});}};